# Copilot Instructions for HN Themer

## Project Overview
This is a Chrome/browser extension that provides theming and font customization for Hacker News (news.ycombinator.com). The extension allows users to apply different visual themes, fonts, and text sizes to enhance their Hacker News reading experience.

## Project Structure
- `manifest.json` - Extension manifest (Manifest V3)
- `popup.html/css/js` - Extension popup interface for user settings
- `content.js` - Content script that applies styling to Hacker News pages
- `fonts/` - Directory containing custom font files (.woff2 format)
- `icons/` - Extension icons in various sizes

## Key Technologies
- **Chrome Extension Manifest V3**
- **Content Scripts** - Injected into Hacker News pages
- **Chrome Storage API** - For persisting user preferences
- **CSS Custom Properties** - For dynamic theme application
- **Web Fonts** - Custom font loading via `@font-face`

## Coding Conventions
- Use vanilla JavaScript (ES6+) - no frameworks
- Follow Chrome Extension best practices for Manifest V3
- Use `chrome.storage.sync` for user preferences persistence
- CSS selectors should be specific to avoid conflicts with HN's existing styles
- Use `!important` sparingly but necessary for overriding HN's inline styles
- Font loading should use `chrome.runtime.getURL()` for web accessible resources

## Available Themes
- `default` - Original Hacker News appearance
- `dark` - Dark theme with orange accents
- `solarized` - Solarized light color scheme
- `pastel` - Soft pastel colors
- `highcontrast` - High contrast black/white/cyan

## Available Fonts
- `default` - Original HN fonts (Verdana)
- `Inter` - Modern sans-serif
- `Poppins` - Rounded sans-serif  
- `Merriweather` - Serif font
- `Fira Code` - Monospace font

## Key Functions & Architecture
- **Theme Application**: Uses CSS custom properties and data attributes (`data-hn-theme`)
- **Font Loading**: Dynamic `@font-face` injection via content scripts
- **Settings Storage**: Chrome sync storage for cross-device preferences
- **Message Passing**: Popup communicates with content script via `chrome.tabs.sendMessage`

## Development Guidelines
1. **Testing**: Always test on actual Hacker News pages across different themes
2. **Performance**: Keep CSS minimal and avoid expensive selectors
3. **Compatibility**: Ensure styles work with HN's table-based layout
4. **Accessibility**: Maintain color contrast ratios, especially for high contrast theme
5. **Web Store Compliance**: Follow Chrome Web Store policies for content scripts

## Common Patterns
- Settings changes trigger immediate preview via message passing
- CSS is injected as `<style>` elements with unique IDs for easy replacement
- Font files are loaded as web accessible resources
- All user preferences are stored in sync storage for cross-device sync

## File Modification Guidelines
- **manifest.json**: Update version on releases, maintain permissions scope
- **content.js**: New themes go in `themeStyles` constant, fonts in `availableFonts` object
- **popup.html**: Add new options to relevant `<select>` elements
- **popup.css**: Keep consistent with HN orange accent color (#ff6600)

## Browser Compatibility
- Primary target: Chrome/Chromium-based browsers
- Uses Manifest V3 APIs (required for Chrome Web Store)
- Font loading uses modern web standards (WOFF2 format)

## Performance Considerations
- Content script runs at `document_start` for immediate theme application
- Minimal DOM queries and mutations
- Font files are lazy-loaded only when selected
- CSS rules are scoped to avoid global impacts